<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FRED Score Dashboard - Carrier Violation Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            padding: 20px 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }
        .header p {
            opacity: 0.8;
            font-size: 14px;
            margin-top: 5px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .search-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .search-section h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #2c5282;
        }
        .search-container {
            position: relative;
        }
        #carrierSearch {
            width: 100%;
            padding: 14px 20px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            outline: none;
            transition: border-color 0.2s;
        }
        #carrierSearch:focus {
            border-color: #3182ce;
        }
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
        }
        .search-result-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
        }
        .search-result-item:hover {
            background: #f7fafc;
        }
        .search-result-item .carrier-name {
            font-weight: 600;
            color: #2d3748;
        }
        .search-result-item .carrier-info {
            font-size: 13px;
            color: #718096;
            margin-top: 2px;
        }
        .carrier-details {
            display: none;
        }
        .carrier-details.active {
            display: block;
        }
        .carrier-header {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .carrier-title {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 20px;
        }
        .carrier-title h2 {
            font-size: 24px;
            color: #1a365d;
        }
        .carrier-title .dot-number {
            font-size: 14px;
            color: #718096;
            font-weight: normal;
        }
        .grade-badge {
            font-size: 36px;
            font-weight: 700;
            padding: 10px 25px;
            border-radius: 12px;
            color: white;
        }
        .grade-A { background: linear-gradient(135deg, #38a169 0%, #2f855a 100%); }
        .grade-B { background: linear-gradient(135deg, #3182ce 0%, #2b6cb0 100%); }
        .grade-C { background: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%); }
        .grade-D { background: linear-gradient(135deg, #dd6b20 0%, #c05621 100%); }
        .grade-F { background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%); }
        .grade-NA { background: linear-gradient(135deg, #718096 0%, #4a5568 100%); }
        .carrier-meta {
            display: flex;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .meta-item {
            font-size: 14px;
        }
        .meta-item .label {
            color: #718096;
        }
        .meta-item .value {
            font-weight: 600;
            color: #2d3748;
        }
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .score-card {
            background: #f7fafc;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }
        .score-card .score-label {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .score-card .score-value {
            font-size: 28px;
            font-weight: 700;
            color: #2d3748;
            margin-top: 5px;
        }
        .score-card .score-value.good { color: #38a169; }
        .score-card .score-value.medium { color: #d69e2e; }
        .score-card .score-value.bad { color: #e53e3e; }
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
        }
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .chart-container h3 {
            font-size: 16px;
            color: #2c5282;
            margin-bottom: 20px;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        .risk-flags {
            background: #fff5f5;
            border: 1px solid #feb2b2;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
        }
        .risk-flags h4 {
            color: #c53030;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .risk-flags ul {
            list-style: none;
            padding-left: 0;
        }
        .risk-flags li {
            padding: 5px 0;
            font-size: 14px;
            color: #742a2a;
        }
        .risk-flags li::before {
            content: "\26A0";
            margin-right: 8px;
        }
        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }
        .no-data h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }
        .stats-row {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .stat-box {
            background: #f7fafc;
            border-radius: 8px;
            padding: 16px 24px;
            text-align: center;
            flex: 1;
            min-width: 150px;
        }
        .stat-box .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
        }
        .stat-box .stat-label {
            font-size: 12px;
            color: #718096;
            margin-top: 5px;
        }
        .ranking-info {
            background: #ebf8ff;
            border: 1px solid #90cdf4;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
        }
        .ranking-info h4 {
            color: #2b6cb0;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .ranking-info p {
            font-size: 14px;
            color: #2c5282;
        }
        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            .chart-wrapper {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>FRED Score Dashboard</h1>
        <p>Carrier Violation Analysis &amp; Safety Trends | 100 carriers indexed</p>
    </div>

    <div class="container">
        <div class="search-section">
            <h2>Search for a Carrier</h2>
            <div class="search-container">
                <input type="text" id="carrierSearch" placeholder="Enter carrier name or DOT number..." autocomplete="off">
                <div id="searchResults" class="search-results"></div>
            </div>
        </div>

        <div id="carrierDetails" class="carrier-details">
            <div class="carrier-header">
                <div class="carrier-title">
                    <div>
                        <h2 id="carrierName">-</h2>
                        <span class="dot-number">DOT# <span id="carrierDOT">-</span></span>
                    </div>
                    <div id="gradeBadge" class="grade-badge grade-NA">-</div>
                </div>

                <div class="carrier-meta">
                    <div class="meta-item">
                        <span class="label">Location:</span>
                        <span class="value" id="carrierLocation">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="label">Power Units:</span>
                        <span class="value" id="carrierPowerUnits">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="label">Drivers:</span>
                        <span class="value" id="carrierDrivers">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="label">Annual Mileage:</span>
                        <span class="value" id="carrierMileage">-</span>
                    </div>
                </div>

                <div class="scores-grid">
                    <div class="score-card">
                        <div class="score-label">Combined Score</div>
                        <div class="score-value" id="scoreCombined">-</div>
                    </div>
                    <div class="score-card">
                        <div class="score-label">Experience</div>
                        <div class="score-value" id="scoreExperience">-</div>
                    </div>
                    <div class="score-card">
                        <div class="score-label">Safety</div>
                        <div class="score-value" id="scoreSafety">-</div>
                    </div>
                    <div class="score-card">
                        <div class="score-label">Crash</div>
                        <div class="score-value" id="scoreCrash">-</div>
                    </div>
                    <div class="score-card">
                        <div class="score-label">Inspection</div>
                        <div class="score-value" id="scoreInspection">-</div>
                    </div>
                </div>

                <div class="stats-row">
                    <div class="stat-box">
                        <div class="stat-value" id="statCrashes">-</div>
                        <div class="stat-label">Crashes</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="statInspections">-</div>
                        <div class="stat-label">Inspections</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="statViolations">-</div>
                        <div class="stat-label">Violations</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="statInsurance">-</div>
                        <div class="stat-label">Insurance Rating</div>
                    </div>
                </div>

                <div id="rankingInfo" class="ranking-info" style="display:none;">
                    <h4>Ranking Information</h4>
                    <p id="rankingText">-</p>
                </div>

                <div id="riskFlags" class="risk-flags" style="display:none;">
                    <h4>Risk Flags</h4>
                    <ul id="riskFlagsList"></ul>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-container">
                    <h3>Violation Trends by Category (Last 2 Years)</h3>
                    <div class="chart-wrapper">
                        <canvas id="trendChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Critical Violations by Category (Severity &ge; 7)</h3>
                    <div class="chart-wrapper">
                        <canvas id="criticalTrendChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Total Violations by BASIC Category</h3>
                    <div class="chart-wrapper">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Critical vs Regular Violations</h3>
                    <div class="chart-wrapper">
                        <canvas id="severityChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div id="noSelection" class="no-data">
            <h3>Select a Carrier</h3>
            <p>Use the search box above to find a carrier by name or DOT number.</p>
        </div>
    </div>

    <script>
        // Carrier data
        const CARRIERS = [{"dot_number": "1", "legal_name": "FEDERAL MOTOR CARRIER SAFETY ADMINISTRATION", "dba_name": "FMCSA TECHNOLOGY DIVISION", "physical_city": "WASHINGTON", "physical_state": "DC", "power_units": 91, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 36, "annual_mileage": 3000, "violation_trends": {"Driver Fitness": {"Q1 2025": 1, "Q4 2025": 4}, "Vehicle Maintenance": {"Q1 2025": 7, "Q4 2025": 14, "Q3 2025": 4}, "Hours-of-Service Compliance": {"Q4 2025": 1, "Q1 2025": 1}, "Unsafe Driving": {"Q4 2025": 4}}, "critical_trends": {"Driver Fitness": {"Q1 2025": 1}, "Vehicle Maintenance": {"Q1 2025": 1, "Q4 2025": 1, "Q3 2025": 2}, "Unsafe Driving": {"Q4 2025": 1}}}, {"dot_number": "44", "legal_name": "GLEN DYER", "dba_name": "DYERS TRUCKING SERVICE", "physical_city": "MOBILE", "physical_state": "AL", "power_units": 3, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "111", "legal_name": "CAIN AM BICKLEY LLC", "dba_name": null, "physical_city": "MARSHALLVILLE", "physical_state": "GA", "power_units": 9, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A+", "rank": 1, "insurance_rating": 26.19, "risk_flags": "", "crash_count": 0, "inspection_count": 4, "violation_count": 1, "annual_mileage": 220000, "violation_trends": {"Unsafe Driving": {"Q2 2025": 1}}, "critical_trends": {"Unsafe Driving": {"Q2 2025": 1}}}, {"dot_number": "174", "legal_name": "CWT FARMS INTERNATIONAL INC", "dba_name": null, "physical_city": "GAINESVILLE", "physical_state": "GA", "power_units": 8, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 90.0, "combined_score": 98.0, "fred_score_grade": "C", "rank": 40, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 4, "violation_count": 0, "annual_mileage": 121904, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "198", "legal_name": "TRANSPORTATION SERVICES INC", "dba_name": null, "physical_city": "ROMULUS", "physical_state": "MI", "power_units": 534, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "D+", "rank": 51, "insurance_rating": 42.43, "risk_flags": "High crash frequency (29 crashes); Pattern: Vehicle Maintenance (158 violations); Pattern: Unsafe Driving (54 violations); Pattern: Hours-of-Service Compliance (38 violations)", "crash_count": 29, "inspection_count": 835, "violation_count": 259, "annual_mileage": 99240000, "violation_trends": {"Hours-of-Service Compliance": {"Q3 2025": 5, "Q1 2025": 1, "Q3 2024": 1, "Q4 2025": 13, "Q4 2024": 6, "Q2 2025": 4, "Q1 2024": 3, "Q2 2024": 4}, "Vehicle Maintenance": {"Q1 2025": 23, "Q2 2024": 23, "Q1 2024": 12, "Q3 2025": 17, "Q4 2024": 14, "Q3 2024": 22, "Q4 2025": 22, "Q2 2025": 21}, "Driver Fitness": {"Q2 2024": 1, "Q4 2025": 2, "Q3 2024": 2, "Q3 2025": 1, "Q4 2024": 2, "Q1 2024": 1}, "Unsafe Driving": {"Q1 2024": 6, "Q4 2024": 6, "Q4 2025": 5, "Q1 2025": 4, "Q3 2024": 14, "Q2 2025": 6, "Q2 2024": 8, "Q3 2025": 4}}, "critical_trends": {"Vehicle Maintenance": {"Q1 2025": 4, "Q2 2024": 6, "Q1 2024": 3, "Q3 2025": 4, "Q4 2024": 1, "Q3 2024": 8, "Q4 2025": 4, "Q2 2025": 3}, "Driver Fitness": {"Q2 2024": 1, "Q4 2024": 1}, "Unsafe Driving": {"Q1 2024": 2, "Q4 2024": 1, "Q4 2025": 1, "Q1 2025": 1, "Q3 2024": 1, "Q2 2025": 1, "Q3 2025": 1}, "Hours-of-Service Compliance": {"Q4 2024": 2, "Q1 2024": 1}}}, {"dot_number": "206", "legal_name": "C & K TRANSFER LLC", "dba_name": null, "physical_city": "GRINNELL", "physical_state": "IA", "power_units": 12, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A+", "rank": 2, "insurance_rating": 309.51, "risk_flags": "High crash frequency (1 crashes); Pattern: Unsafe Driving (13 violations); Pattern: Vehicle Maintenance (11 violations)", "crash_count": 1, "inspection_count": 36, "violation_count": 31, "annual_mileage": 880000, "violation_trends": {"Driver Fitness": {"Q3 2024": 3}, "Vehicle Maintenance": {"Q4 2025": 3, "Q3 2024": 2, "Q4 2024": 3, "Q2 2025": 3}, "Unsafe Driving": {"Q3 2025": 1, "Q2 2025": 4, "Q3 2024": 2, "Q1 2025": 4, "Q2 2024": 2}, "Hours-of-Service Compliance": {"Q2 2025": 1, "Q4 2025": 2, "Q2 2024": 1}}, "critical_trends": {"Unsafe Driving": {"Q2 2025": 2, "Q3 2024": 2, "Q1 2025": 1, "Q2 2024": 1}, "Vehicle Maintenance": {"Q2 2025": 1}, "Hours-of-Service Compliance": {"Q2 2024": 1}}}, {"dot_number": "234", "legal_name": "DOUG ANDRUS DISTRIBUTING LLC", "dba_name": null, "physical_city": "IDAHO FALLS", "physical_state": "ID", "power_units": 255, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "D+", "rank": 52, "insurance_rating": 82.72, "risk_flags": "High crash frequency (12 crashes); Pattern: Hours-of-Service Compliance (35 violations); Pattern: Unsafe Driving (16 violations); Pattern: Vehicle Maintenance (108 violations)", "crash_count": 12, "inspection_count": 561, "violation_count": 166, "annual_mileage": 25160964, "violation_trends": {"Hours-of-Service Compliance": {"Q3 2024": 2, "Q1 2024": 6, "Q2 2024": 4, "Q2 2025": 5, "Q3 2025": 3, "Q4 2025": 5, "Q1 2025": 5, "Q4 2024": 4}, "Unsafe Driving": {"Q1 2025": 3, "Q2 2025": 1, "Q4 2025": 2, "Q3 2025": 2, "Q1 2024": 2, "Q3 2024": 2, "Q2 2024": 3}, "Driver Fitness": {"Q4 2024": 1, "Q3 2025": 1, "Q2 2025": 1, "Q1 2025": 3, "Q4 2025": 1}, "Vehicle Maintenance": {"Q3 2024": 19, "Q4 2024": 8, "Q4 2025": 15, "Q2 2024": 8, "Q1 2025": 20, "Q3 2025": 12, "Q1 2024": 7, "Q2 2025": 16}}, "critical_trends": {"Unsafe Driving": {"Q1 2025": 1, "Q2 2024": 3}, "Hours-of-Service Compliance": {"Q1 2024": 1, "Q2 2025": 3, "Q3 2025": 1, "Q4 2025": 2, "Q4 2024": 2}, "Vehicle Maintenance": {"Q3 2024": 3, "Q4 2024": 4, "Q4 2025": 2, "Q2 2024": 3, "Q1 2025": 3, "Q3 2025": 2, "Q1 2024": 1, "Q2 2025": 7}, "Driver Fitness": {"Q1 2025": 2, "Q4 2025": 1}}}, {"dot_number": "239", "legal_name": "FELIX ANCHUSTEGUI TRUCKING INC", "dba_name": null, "physical_city": "NAMPA", "physical_state": "ID", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 90.0, "combined_score": 98.0, "fred_score_grade": "C", "rank": 41, "insurance_rating": 48.14, "risk_flags": "", "crash_count": 0, "inspection_count": 5, "violation_count": 1, "annual_mileage": 119687, "violation_trends": {"Unsafe Driving": {"Q3 2024": 1}}, "critical_trends": {}}, {"dot_number": "254", "legal_name": "RICHARD D AUSTIN", "dba_name": "AUSTIN TRUCKING", "physical_city": "SALMON", "physical_state": "ID", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 1251, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "261", "legal_name": "BOISE DELIVERY & TRANSFER INC", "dba_name": null, "physical_city": "BOISE", "physical_state": "ID", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "334", "legal_name": "D ALI TRUCKING INC", "dba_name": null, "physical_city": "OAKDALE", "physical_state": "PA", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 1, "annual_mileage": 12624, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "345", "legal_name": "W J BEITLER CO", "dba_name": null, "physical_city": "PITTSBURGH", "physical_state": "PA", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 2, "violation_count": 4, "annual_mileage": 1, "violation_trends": {"Vehicle Maintenance": {"Q3 2025": 3}, "Driver Fitness": {"Q3 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2025": 1}}}, {"dot_number": "374", "legal_name": "MOHAWK CARPET TRANSPORTATION OF GEORGIA LLC", "dba_name": "MOHAWK", "physical_city": "CALHOUN", "physical_state": "GA", "power_units": 992, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "D+", "rank": 53, "insurance_rating": 117.12, "risk_flags": "High crash frequency (40 crashes); Pattern: Hours-of-Service Compliance (34 violations); Pattern: Vehicle Maintenance (275 violations); Pattern: Unsafe Driving (54 violations)", "crash_count": 40, "inspection_count": 1360, "violation_count": 371, "annual_mileage": 50268376, "violation_trends": {"Hours-of-Service Compliance": {"Q1 2025": 4, "Q2 2024": 6, "Q3 2025": 1, "Q4 2025": 5, "Q2 2025": 9, "Q1 2024": 3, "Q3 2024": 4}, "Vehicle Maintenance": {"Q4 2024": 35, "Q1 2024": 15, "Q4 2025": 34, "Q3 2024": 48, "Q3 2025": 18, "Q1 2025": 31, "Q2 2025": 44, "Q2 2024": 38}, "Unsafe Driving": {"Q3 2024": 6, "Q2 2024": 8, "Q1 2024": 4, "Q3 2025": 6, "Q4 2024": 7, "Q4 2025": 6, "Q1 2025": 8, "Q2 2025": 9}, "Driver Fitness": {"Q2 2025": 4, "Q1 2024": 1, "Q3 2024": 1, "Q2 2024": 2}}, "critical_trends": {"Vehicle Maintenance": {"Q4 2024": 3, "Q1 2024": 4, "Q4 2025": 5, "Q3 2024": 7, "Q1 2025": 8, "Q2 2025": 11, "Q2 2024": 14}, "Unsafe Driving": {"Q3 2024": 1, "Q2 2024": 3, "Q1 2024": 3, "Q3 2025": 4, "Q4 2024": 1, "Q1 2025": 4, "Q2 2025": 3}, "Driver Fitness": {"Q2 2025": 1}, "Hours-of-Service Compliance": {"Q2 2025": 1, "Q3 2024": 1}}}, {"dot_number": "525", "legal_name": "ARMSTRONG TRANSFER & STORAGE COMPANY INC", "dba_name": "ARMSTRONG RELOCATION CO", "physical_city": "MEMPHIS", "physical_state": "TN", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 20, "violation_count": 7, "annual_mileage": 66780, "violation_trends": {"Vehicle Maintenance": {"Q1 2024": 1, "Q2 2024": 1, "Q3 2025": 2}, "Hours-of-Service Compliance": {"Q4 2025": 2}, "Unsafe Driving": {"Q4 2025": 1}}, "critical_trends": {}}, {"dot_number": "529", "legal_name": "C W WILLIAMS INC", "dba_name": null, "physical_city": "HICKORY FLAT", "physical_state": "MS", "power_units": 17, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A", "rank": 3, "insurance_rating": 14.38, "risk_flags": "", "crash_count": 0, "inspection_count": 15, "violation_count": 3, "annual_mileage": 1201758, "violation_trends": {"Vehicle Maintenance": {"Q3 2024": 3}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2024": 1}}}, {"dot_number": "536", "legal_name": "BARNHART CRANE AND RIGGING CO", "dba_name": null, "physical_city": "MEMPHIS", "physical_state": "TN", "power_units": 1106, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "D", "rank": 54, "insurance_rating": 350.21, "risk_flags": "High crash frequency (18 crashes); Pattern: Vehicle Maintenance (152 violations); Pattern: Unsafe Driving (45 violations); Pattern: Hours-of-Service Compliance (16 violations)", "crash_count": 18, "inspection_count": 678, "violation_count": 219, "annual_mileage": 8421248, "violation_trends": {"Hours-of-Service Compliance": {"Q4 2025": 2, "Q4 2024": 2, "Q3 2025": 2, "Q1 2025": 2, "Q2 2024": 3, "Q2 2025": 3, "Q3 2024": 1}, "Driver Fitness": {"Q1 2025": 1, "Q3 2025": 1, "Q2 2024": 1, "Q2 2025": 3}, "Unsafe Driving": {"Q4 2025": 3, "Q1 2024": 3, "Q2 2025": 7, "Q4 2024": 7, "Q2 2024": 9, "Q3 2024": 5, "Q3 2025": 7, "Q1 2025": 3}, "Vehicle Maintenance": {"Q1 2024": 17, "Q3 2025": 20, "Q2 2024": 29, "Q2 2025": 26, "Q4 2025": 13, "Q4 2024": 5, "Q1 2025": 12, "Q3 2024": 22}}, "critical_trends": {"Unsafe Driving": {"Q1 2024": 1, "Q2 2025": 3, "Q4 2024": 2, "Q2 2024": 4, "Q3 2024": 2, "Q3 2025": 4, "Q1 2025": 1}, "Vehicle Maintenance": {"Q1 2024": 5, "Q3 2025": 4, "Q2 2024": 2, "Q2 2025": 3, "Q4 2025": 1, "Q4 2024": 1, "Q1 2025": 2}, "Hours-of-Service Compliance": {"Q4 2024": 1, "Q1 2025": 1}, "Driver Fitness": {"Q2 2025": 3}}}, {"dot_number": "594", "legal_name": "DUFFY CRANE INC", "dba_name": "DUFFY CRANE & HAULING", "physical_city": "HENDERSON", "physical_state": "CO", "power_units": 47, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A", "rank": 4, "insurance_rating": 191.4, "risk_flags": "High crash frequency (2 crashes); Pattern: Vehicle Maintenance (25 violations)", "crash_count": 2, "inspection_count": 37, "violation_count": 29, "annual_mileage": 1852565, "violation_trends": {"Unsafe Driving": {"Q4 2025": 1, "Q3 2025": 1}, "Vehicle Maintenance": {"Q3 2024": 3, "Q4 2025": 6, "Q4 2024": 9, "Q1 2025": 7}, "Hours-of-Service Compliance": {"Q4 2024": 1}, "Driver Fitness": {"Q1 2025": 1}}, "critical_trends": {"Unsafe Driving": {"Q4 2025": 1, "Q3 2025": 1}, "Hours-of-Service Compliance": {"Q4 2024": 1}, "Vehicle Maintenance": {"Q4 2024": 1, "Q1 2025": 1}, "Driver Fitness": {"Q1 2025": 1}}}, {"dot_number": "603", "legal_name": "EATON SALES & SERVICE LLC", "dba_name": null, "physical_city": "DENVER", "physical_state": "CO", "power_units": 95, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A", "rank": 5, "insurance_rating": 14.41, "risk_flags": "", "crash_count": 0, "inspection_count": 6, "violation_count": 5, "annual_mileage": 2000000, "violation_trends": {"Driver Fitness": {"Q3 2025": 1}, "Vehicle Maintenance": {"Q3 2025": 3}, "Hours-of-Service Compliance": {"Q1 2025": 1}}, "critical_trends": {"Driver Fitness": {"Q3 2025": 1}}}, {"dot_number": "619", "legal_name": "EMPIRE WAREHOUSE INC", "dba_name": null, "physical_city": "DENVER", "physical_state": "CO", "power_units": 9, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A", "rank": 6, "insurance_rating": 115.24, "risk_flags": "", "crash_count": 0, "inspection_count": 13, "violation_count": 12, "annual_mileage": 600000, "violation_trends": {"Vehicle Maintenance": {"Q1 2025": 1, "Q3 2025": 6}, "Unsafe Driving": {"Q3 2024": 1}, "Hours-of-Service Compliance": {"Q3 2024": 2, "Q1 2024": 2}}, "critical_trends": {"Hours-of-Service Compliance": {"Q3 2024": 1}}}, {"dot_number": "651", "legal_name": "CHRISTENSEN TRUCKING INC", "dba_name": null, "physical_city": "FULLERTON", "physical_state": "NE", "power_units": 7, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A-", "rank": 7, "insurance_rating": 30.38, "risk_flags": "", "crash_count": 0, "inspection_count": 11, "violation_count": 2, "annual_mileage": 379395, "violation_trends": {"Unsafe Driving": {"Q3 2025": 2}}, "critical_trends": {}}, {"dot_number": "684", "legal_name": "RICK DICKMAN", "dba_name": "DICKMAN TRANSFER", "physical_city": "AXTELL", "physical_state": "NE", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A-", "rank": 8, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 116015, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "702", "legal_name": "EBEL TRANSFER INC", "dba_name": null, "physical_city": "WEST POINT", "physical_state": "NE", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A-", "rank": 9, "insurance_rating": 64.52, "risk_flags": "", "crash_count": 0, "inspection_count": 14, "violation_count": 3, "annual_mileage": 267932, "violation_trends": {"Unsafe Driving": {"Q3 2024": 1}, "Vehicle Maintenance": {"Q1 2024": 1}}, "critical_trends": {}}, {"dot_number": "716", "legal_name": "EVELAND SUPPLY CO INC", "dba_name": "EVELAND SUPPLY CO", "physical_city": "SCRIBNER", "physical_state": "NE", "power_units": 13, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A-", "rank": 10, "insurance_rating": 407.45, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 6, "violation_count": 2, "annual_mileage": 258349, "violation_trends": {"Unsafe Driving": {"Q3 2024": 1, "Q3 2025": 1}}, "critical_trends": {"Unsafe Driving": {"Q3 2024": 1, "Q3 2025": 1}}}, {"dot_number": "717", "legal_name": "ALBERT FARMS INC", "dba_name": null, "physical_city": "MADAWASKA", "physical_state": "ME", "power_units": 16, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A-", "rank": 11, "insurance_rating": 500, "risk_flags": "High crash frequency (2 crashes); Pattern: Vehicle Maintenance (11 violations)", "crash_count": 2, "inspection_count": 33, "violation_count": 25, "annual_mileage": 540000, "violation_trends": {"Unsafe Driving": {"Q4 2025": 1, "Q3 2025": 1, "Q3 2024": 2, "Q1 2025": 1, "Q2 2025": 1, "Q2 2024": 1}, "Vehicle Maintenance": {"Q2 2024": 2, "Q3 2024": 1, "Q2 2025": 3, "Q3 2025": 3, "Q4 2025": 2}, "Hours-of-Service Compliance": {"Q4 2024": 1, "Q3 2024": 2}, "Driver Fitness": {"Q3 2024": 1, "Q1 2025": 2}, "Controlled Substances/&#8203;Alcohol": {"Q4 2025": 1}}, "critical_trends": {"Unsafe Driving": {"Q4 2025": 1, "Q3 2025": 1, "Q1 2025": 1}, "Hours-of-Service Compliance": {"Q4 2024": 1, "Q3 2024": 2}, "Driver Fitness": {"Q3 2024": 1, "Q1 2025": 1}, "Vehicle Maintenance": {"Q3 2025": 1}}}, {"dot_number": "726", "legal_name": "FOLTZ BROTHERS INC", "dba_name": null, "physical_city": "HUMPHREY", "physical_state": "NE", "power_units": 6, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "A-", "rank": 12, "insurance_rating": 31.63, "risk_flags": "", "crash_count": 0, "inspection_count": 7, "violation_count": 1, "annual_mileage": 182158, "violation_trends": {"Unsafe Driving": {"Q3 2024": 1}}, "critical_trends": {}}, {"dot_number": "733", "legal_name": "FREMONT CONTRACT CARRIERS INC", "dba_name": null, "physical_city": "FREMONT", "physical_state": "NE", "power_units": 438, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "D", "rank": 55, "insurance_rating": 79.16, "risk_flags": "High crash frequency (24 crashes); Pattern: Vehicle Maintenance (152 violations); Pattern: Hours-of-Service Compliance (36 violations); Pattern: Unsafe Driving (68 violations)", "crash_count": 24, "inspection_count": 1163, "violation_count": 258, "annual_mileage": 47198832, "violation_trends": {"Hours-of-Service Compliance": {"Q1 2025": 2, "Q1 2024": 3, "Q2 2025": 4, "Q4 2024": 8, "Q4 2025": 1, "Q2 2024": 6, "Q3 2024": 5, "Q3 2025": 6}, "Unsafe Driving": {"Q3 2025": 9, "Q3 2024": 17, "Q1 2024": 5, "Q2 2025": 6, "Q2 2024": 8, "Q4 2024": 7, "Q4 2025": 8, "Q1 2025": 6}, "Vehicle Maintenance": {"Q3 2025": 23, "Q2 2025": 21, "Q3 2024": 20, "Q4 2025": 27, "Q4 2024": 9, "Q1 2024": 11, "Q1 2025": 18, "Q2 2024": 18}, "Driver Fitness": {"Q4 2025": 1, "Q4 2024": 1}}, "critical_trends": {"Unsafe Driving": {"Q3 2025": 2, "Q3 2024": 3, "Q1 2024": 2, "Q2 2025": 3, "Q2 2024": 4, "Q4 2024": 3, "Q4 2025": 1}, "Hours-of-Service Compliance": {"Q1 2024": 1, "Q4 2024": 1, "Q2 2024": 2, "Q3 2024": 1}, "Vehicle Maintenance": {"Q3 2025": 1, "Q2 2025": 4, "Q3 2024": 7, "Q4 2025": 6, "Q4 2024": 3, "Q1 2024": 5, "Q1 2025": 4, "Q2 2024": 3}, "Driver Fitness": {"Q4 2025": 1, "Q4 2024": 1}}}, {"dot_number": "748", "legal_name": "GLODOWSKI TRUCKING INC", "dba_name": null, "physical_city": "ROGERS", "physical_state": "NE", "power_units": 3, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B+", "rank": 13, "insurance_rating": 46.1, "risk_flags": "", "crash_count": 0, "inspection_count": 3, "violation_count": 1, "annual_mileage": 125000, "violation_trends": {"Unsafe Driving": {"Q4 2025": 1}}, "critical_trends": {}}, {"dot_number": "754", "legal_name": "GRAHAM TRUCKING CO INC", "dba_name": null, "physical_city": "VALENTINE", "physical_state": "NE", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 2, "violation_count": 0, "annual_mileage": 70000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "761", "legal_name": "GROSCH IRRIGATION CO INC", "dba_name": null, "physical_city": "ONEILL", "physical_state": "NE", "power_units": 87, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 90.0, "combined_score": 98.0, "fred_score_grade": "C", "rank": 42, "insurance_rating": 500, "risk_flags": "Pattern: Vehicle Maintenance (14 violations)", "crash_count": 0, "inspection_count": 10, "violation_count": 14, "annual_mileage": 129824, "violation_trends": {"Vehicle Maintenance": {"Q2 2025": 8, "Q3 2024": 5, "Q1 2024": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q2 2025": 1}}}, {"dot_number": "762", "legal_name": "GROSSERHODE TRANSFER", "dba_name": null, "physical_city": "DODGE", "physical_state": "NE", "power_units": 3, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 3, "annual_mileage": 67859, "violation_trends": {"Vehicle Maintenance": {"Q4 2025": 3}}, "critical_trends": {}}, {"dot_number": "787", "legal_name": "MIDWEST OIL CO INC", "dba_name": null, "physical_city": "SIOUX FALLS", "physical_state": "SD", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 8, "violation_count": 3, "annual_mileage": 28000, "violation_trends": {"Vehicle Maintenance": {"Q3 2024": 3}}, "critical_trends": {}}, {"dot_number": "812", "legal_name": "MITZEL & SONS INC", "dba_name": null, "physical_city": "ABERDEEN", "physical_state": "SD", "power_units": 6, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 90.0, "combined_score": 98.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 4, "violation_count": 2, "annual_mileage": 93643, "violation_trends": {"Vehicle Maintenance": {"Q1 2025": 2}}, "critical_trends": {"Vehicle Maintenance": {"Q1 2025": 1}}}, {"dot_number": "819", "legal_name": "MOELLER TRUCK SERVICE INC", "dba_name": null, "physical_city": "BRYANT", "physical_state": "SD", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 2, "violation_count": 1, "annual_mileage": 70000, "violation_trends": {"Vehicle Maintenance": {"Q2 2025": 1}}, "critical_trends": {}}, {"dot_number": "835", "legal_name": "MOYLE PETROLEUM COMPANY", "dba_name": null, "physical_city": "RAPID CITY", "physical_state": "SD", "power_units": 16, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B+", "rank": 14, "insurance_rating": 54.14, "risk_flags": "", "crash_count": 0, "inspection_count": 19, "violation_count": 3, "annual_mileage": 319291, "violation_trends": {"Hazardous Materials Compliance": {"Q2 2024": 1}, "Vehicle Maintenance": {"Q3 2024": 1, "Q2 2024": 1}}, "critical_trends": {}}, {"dot_number": "844", "legal_name": "MUSICK LIVESTOCK LLC", "dba_name": null, "physical_city": "MITCHELL", "physical_state": "SD", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B+", "rank": 15, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 101300, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "874", "legal_name": "NIESEN TRUCK LINE INC", "dba_name": null, "physical_city": "BRITTON", "physical_state": "SD", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 80000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "880", "legal_name": "NORTHWEST BEVERAGE INC", "dba_name": null, "physical_city": "MOBRIDGE", "physical_state": "SD", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 45000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "881", "legal_name": "HILLS PRODUCTS GROUP INC", "dba_name": null, "physical_city": "RAPID CITY", "physical_state": "SD", "power_units": 6, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B+", "rank": 16, "insurance_rating": 500, "risk_flags": "Pattern: Vehicle Maintenance (20 violations)", "crash_count": 0, "inspection_count": 21, "violation_count": 22, "annual_mileage": 178207, "violation_trends": {"Vehicle Maintenance": {"Q2 2024": 3, "Q1 2024": 4, "Q3 2024": 6, "Q4 2025": 1, "Q1 2025": 2, "Q2 2025": 4}, "Unsafe Driving": {"Q2 2025": 1}, "Hours-of-Service Compliance": {"Q2 2024": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2024": 1}}}, {"dot_number": "909", "legal_name": "JERALD OLLERICH", "dba_name": "JERRY OLLERICH TRUCKING", "physical_city": "SIOUX FALLS", "physical_state": "SD", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B+", "rank": 17, "insurance_rating": 223.77, "risk_flags": "", "crash_count": 0, "inspection_count": 4, "violation_count": 4, "annual_mileage": 103000, "violation_trends": {"Vehicle Maintenance": {"Q1 2024": 4}}, "critical_trends": {}}, {"dot_number": "920", "legal_name": "OPPERMAN INC", "dba_name": null, "physical_city": "GREGORY", "physical_state": "SD", "power_units": 19, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B+", "rank": 18, "insurance_rating": 10.8, "risk_flags": "", "crash_count": 0, "inspection_count": 9, "violation_count": 1, "annual_mileage": 533396, "violation_trends": {"Vehicle Maintenance": {"Q2 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q2 2025": 1}}}, {"dot_number": "923", "legal_name": "OUELLETTE TRUCKING INC", "dba_name": null, "physical_city": "VERMILLION", "physical_state": "SD", "power_units": 8, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 19, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 9, "violation_count": 0, "annual_mileage": 759479, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "943", "legal_name": "CHRIS CAM CORPORATION", "dba_name": "HEARTLAND PAPER CO", "physical_city": "SIOUX FALLS", "physical_state": "SD", "power_units": 19, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 20, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 1199000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "945", "legal_name": "PARKER TRANSFER AND STORAGE INC", "dba_name": "PARKER", "physical_city": "SIOUX FALLS", "physical_state": "SD", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 5, "violation_count": 0, "annual_mileage": 36000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "969", "legal_name": "PERKINS STORAGE & TRANSFER CO INC", "dba_name": null, "physical_city": "BROOKINGS", "physical_state": "SD", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 70.0, "combined_score": 94.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "High OOS rate (100.0%)", "crash_count": 0, "inspection_count": 1, "violation_count": 1, "annual_mileage": 50000, "violation_trends": {"Vehicle Maintenance": {"Q1 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q1 2025": 1}}}, {"dot_number": "979", "legal_name": "BULK CARRIERS SPECIALISTS INC", "dba_name": null, "physical_city": "OMAHA", "physical_state": "NE", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 31894, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1018", "legal_name": "ROBERT AND ROGER PUNT", "dba_name": "PUNT TRUCKING", "physical_city": "STICKNEY", "physical_state": "SD", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 21, "insurance_rating": 44.1, "risk_flags": "", "crash_count": 0, "inspection_count": 11, "violation_count": 3, "annual_mileage": 392000, "violation_trends": {"Hours-of-Service Compliance": {"Q3 2024": 2}, "Vehicle Maintenance": {"Q3 2024": 1}}, "critical_trends": {"Hours-of-Service Compliance": {"Q3 2024": 1}, "Vehicle Maintenance": {"Q3 2024": 1}}}, {"dot_number": "1044", "legal_name": "RICH GRANT TRUCKING CO", "dba_name": null, "physical_city": "OGDEN", "physical_state": "UT", "power_units": 10, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 22, "insurance_rating": 253.71, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 12, "violation_count": 3, "annual_mileage": 437606, "violation_trends": {"Hours-of-Service Compliance": {"Q1 2024": 2}, "Driver Fitness": {"Q3 2025": 1}}, "critical_trends": {}}, {"dot_number": "1060", "legal_name": "JUNIOR LISH & SONS INC", "dba_name": null, "physical_city": "GARLAND", "physical_state": "UT", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 37266, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1114", "legal_name": "RMC FOODS INC", "dba_name": null, "physical_city": "SAINT GEORGE", "physical_state": "UT", "power_units": 38, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 23, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 1595778, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1115", "legal_name": "KOMATSU AMERICA CORP", "dba_name": "KOMATSU", "physical_city": "CHICAGO", "physical_state": "IL", "power_units": 52, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 90.0, "inspection_score": 100.0, "combined_score": 97.0, "fred_score_grade": "C-", "rank": 45, "insurance_rating": 443.04, "risk_flags": "High crash frequency (3 crashes); Pattern: Vehicle Maintenance (26 violations); Pattern: Unsafe Driving (11 violations)", "crash_count": 3, "inspection_count": 79, "violation_count": 43, "annual_mileage": 1193998, "violation_trends": {"Unsafe Driving": {"Q3 2025": 2, "Q2 2025": 3, "Q2 2024": 3, "Q4 2024": 1, "Q1 2024": 2}, "Vehicle Maintenance": {"Q4 2024": 6, "Q3 2025": 4, "Q2 2025": 2, "Q3 2024": 4, "Q1 2025": 3, "Q2 2024": 3}, "Driver Fitness": {"Q2 2024": 1, "Q1 2024": 1, "Q3 2025": 2, "Q2 2025": 1}, "Hours-of-Service Compliance": {"Q4 2025": 1}}, "critical_trends": {"Unsafe Driving": {"Q2 2025": 1, "Q2 2024": 1, "Q1 2024": 2}, "Driver Fitness": {"Q3 2025": 1}}}, {"dot_number": "1122", "legal_name": "NICHOLAS AND COMPANY INC", "dba_name": null, "physical_city": "SALT LAKE CITY", "physical_state": "UT", "power_units": 148, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 90.0, "inspection_score": 100.0, "combined_score": 97.0, "fred_score_grade": "C-", "rank": 46, "insurance_rating": 96.44, "risk_flags": "High crash frequency (3 crashes); Pattern: Vehicle Maintenance (54 violations)", "crash_count": 3, "inspection_count": 107, "violation_count": 62, "annual_mileage": 6620310, "violation_trends": {"Unsafe Driving": {"Q4 2025": 1, "Q2 2024": 1, "Q3 2024": 1, "Q1 2025": 1}, "Driver Fitness": {"Q1 2024": 2}, "Hours-of-Service Compliance": {"Q1 2025": 1, "Q4 2025": 1}, "Vehicle Maintenance": {"Q4 2024": 20, "Q2 2024": 1, "Q3 2025": 1, "Q1 2025": 5, "Q1 2024": 11, "Q2 2025": 4, "Q4 2025": 3, "Q3 2024": 9}}, "critical_trends": {"Driver Fitness": {"Q1 2024": 2}, "Hours-of-Service Compliance": {"Q1 2025": 1}, "Vehicle Maintenance": {"Q4 2024": 1, "Q1 2024": 1, "Q4 2025": 1}, "Unsafe Driving": {"Q2 2024": 1, "Q3 2024": 1, "Q1 2025": 1}}}, {"dot_number": "1253", "legal_name": "ARIS HORTICULTURE INC", "dba_name": null, "physical_city": "BARBERTON", "physical_state": "OH", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 4, "violation_count": 3, "annual_mileage": 15000, "violation_trends": {"Vehicle Maintenance": {"Q1 2025": 1}, "Hours-of-Service Compliance": {"Q3 2025": 1}, "Unsafe Driving": {"Q3 2025": 1}}, "critical_trends": {}}, {"dot_number": "1283", "legal_name": "ROBERT E WELLS INC", "dba_name": null, "physical_city": "WEST JORDAN", "physical_state": "UT", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 25150, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1302", "legal_name": "WHEELER MACHINERY CO", "dba_name": "ICM SOLUTIONS WHEELER POWER SYSTEMS HERITAGE IND DIAMOND EQUIPMENT RENTAL", "physical_city": "SALT LAKE CITY", "physical_state": "UT", "power_units": 204, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 24, "insurance_rating": 30.1, "risk_flags": "High crash frequency (1 crashes); Pattern: Vehicle Maintenance (11 violations)", "crash_count": 1, "inspection_count": 56, "violation_count": 18, "annual_mileage": 6560574, "violation_trends": {"Unsafe Driving": {"Q1 2025": 1, "Q4 2024": 2, "Q3 2024": 1, "Q2 2024": 1}, "Hours-of-Service Compliance": {"Q2 2025": 1}, "Vehicle Maintenance": {"Q1 2024": 1, "Q3 2024": 2, "Q2 2025": 2, "Q1 2025": 4, "Q4 2025": 1}, "Driver Fitness": {"Q4 2025": 1}}, "critical_trends": {"Unsafe Driving": {"Q4 2024": 1}, "Driver Fitness": {"Q4 2025": 1}}}, {"dot_number": "1362", "legal_name": "RISTVEDT TRUCKING INC", "dba_name": "RISTVEDT", "physical_city": "WATERTOWN", "physical_state": "SD", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 25, "insurance_rating": 52.0, "risk_flags": "", "crash_count": 0, "inspection_count": 9, "violation_count": 2, "annual_mileage": 221622, "violation_trends": {"Hours-of-Service Compliance": {"Q4 2024": 1}, "Vehicle Maintenance": {"Q1 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q1 2025": 1}}}, {"dot_number": "1391", "legal_name": "RUDE TRANSPORTATION INC", "dba_name": null, "physical_city": "SIOUX FALLS", "physical_state": "SD", "power_units": 68, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 90.0, "inspection_score": 100.0, "combined_score": 97.0, "fred_score_grade": "C-", "rank": 47, "insurance_rating": 136.07, "risk_flags": "High crash frequency (3 crashes)", "crash_count": 3, "inspection_count": 110, "violation_count": 25, "annual_mileage": 3125384, "violation_trends": {"Unsafe Driving": {"Q3 2024": 3, "Q3 2025": 1, "Q2 2025": 1, "Q4 2024": 2, "Q2 2024": 1}, "Hazardous Materials Compliance": {"Q3 2025": 1, "Q2 2024": 1}, "Vehicle Maintenance": {"Q2 2024": 2, "Q3 2024": 1, "Q3 2025": 4}, "Driver Fitness": {"Q2 2025": 1}, "Hours-of-Service Compliance": {"Q2 2024": 3, "Q2 2025": 1, "Q3 2024": 2}}, "critical_trends": {"Unsafe Driving": {"Q3 2024": 1, "Q4 2024": 2, "Q2 2024": 1}, "Vehicle Maintenance": {"Q2 2024": 1}}}, {"dot_number": "1405", "legal_name": "ROGER ST SAUVER", "dba_name": null, "physical_city": "BRITTON", "physical_state": "SD", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 44715, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1426", "legal_name": "FANTASY LAND EXPRESS LLC", "dba_name": null, "physical_city": "FLANDREAU", "physical_state": "SD", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 3800, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1440", "legal_name": "DAN SCHROEDERMEIER TRUCKING INC", "dba_name": null, "physical_city": "BERESFORD", "physical_state": "SD", "power_units": 18, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 26, "insurance_rating": 129.63, "risk_flags": "High crash frequency (1 crashes); Pattern: Vehicle Maintenance (13 violations)", "crash_count": 1, "inspection_count": 44, "violation_count": 22, "annual_mileage": 1701041, "violation_trends": {"Vehicle Maintenance": {"Q1 2025": 4, "Q2 2024": 1, "Q4 2025": 5, "Q3 2025": 1, "Q2 2025": 2}, "Unsafe Driving": {"Q4 2024": 1, "Q2 2025": 1, "Q3 2024": 1, "Q1 2024": 1}, "Hours-of-Service Compliance": {"Q3 2024": 1, "Q2 2025": 1, "Q3 2025": 1, "Q2 2024": 1, "Q4 2024": 1}}, "critical_trends": {"Unsafe Driving": {"Q4 2024": 1, "Q2 2025": 1}, "Vehicle Maintenance": {"Q4 2025": 1, "Q2 2025": 1}, "Hours-of-Service Compliance": {"Q3 2024": 1, "Q2 2024": 1}}}, {"dot_number": "1637", "legal_name": "WILLIAM NEVILLE", "dba_name": null, "physical_city": "TOLEDO", "physical_state": "IA", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1674", "legal_name": "ART PAPE TRANSFER INC", "dba_name": "TUCKER FREIGHT LINES INC", "physical_city": "DUBUQUE", "physical_state": "IA", "power_units": 340, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "D", "rank": 56, "insurance_rating": 108.55, "risk_flags": "High crash frequency (22 crashes); Pattern: Vehicle Maintenance (81 violations); Pattern: Unsafe Driving (29 violations)", "crash_count": 22, "inspection_count": 485, "violation_count": 124, "annual_mileage": 25581000, "violation_trends": {"Vehicle Maintenance": {"Q4 2025": 8, "Q4 2024": 13, "Q2 2025": 9, "Q2 2024": 16, "Q1 2025": 8, "Q3 2024": 14, "Q3 2025": 10}, "Unsafe Driving": {"Q1 2025": 2, "Q3 2025": 3, "Q2 2024": 4, "Q4 2024": 3, "Q2 2025": 4, "Q4 2025": 6, "Q3 2024": 2, "Q1 2024": 5}, "Hours-of-Service Compliance": {"Q4 2024": 2, "Q3 2025": 2, "Q2 2025": 2, "Q4 2025": 3}, "Driver Fitness": {"Q4 2025": 1, "Q1 2025": 2, "Q3 2024": 2}}, "critical_trends": {"Vehicle Maintenance": {"Q4 2025": 3, "Q4 2024": 4, "Q2 2025": 2, "Q2 2024": 4, "Q1 2025": 4, "Q3 2024": 4, "Q3 2025": 5}, "Unsafe Driving": {"Q3 2025": 2, "Q2 2024": 1, "Q4 2024": 2, "Q2 2025": 1, "Q4 2025": 2, "Q3 2024": 1, "Q1 2024": 3}, "Driver Fitness": {"Q4 2025": 1, "Q1 2025": 2, "Q3 2024": 2}, "Hours-of-Service Compliance": {"Q3 2025": 1, "Q2 2025": 1, "Q4 2025": 2}}}, {"dot_number": "1734", "legal_name": "RICHTER STOCK FARM INC", "dba_name": null, "physical_city": "REINBECK", "physical_state": "IA", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 24110, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1749", "legal_name": "JEFFORY ALLEN RUNDLETT", "dba_name": "RUNDLETT TRUCKING", "physical_city": "WATERLOO", "physical_state": "IA", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 90.0, "combined_score": 98.0, "fred_score_grade": "C", "rank": 43, "insurance_rating": 500, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 4, "violation_count": 0, "annual_mileage": 130000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1771", "legal_name": "SCHMUECKER TRUCK LINE INC", "dba_name": null, "physical_city": "EARLVILLE", "physical_state": "IA", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B", "rank": 27, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 3, "violation_count": 0, "annual_mileage": 123668, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1783", "legal_name": "SEEGERS TRUCK LINE INC", "dba_name": null, "physical_city": "DENVER", "physical_state": "IA", "power_units": 16, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B-", "rank": 28, "insurance_rating": 46.9, "risk_flags": "", "crash_count": 0, "inspection_count": 38, "violation_count": 7, "annual_mileage": 859962, "violation_trends": {"Vehicle Maintenance": {"Q2 2024": 2, "Q3 2025": 1, "Q1 2024": 1}, "Hours-of-Service Compliance": {"Q1 2024": 2, "Q4 2024": 1}}, "critical_trends": {}}, {"dot_number": "1821", "legal_name": "IVAN STEINBECK TRUCKING", "dba_name": null, "physical_city": "BRANDON", "physical_state": "IA", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1859", "legal_name": "DAVID BARSTOW TRUCKING", "dba_name": null, "physical_city": "SAINT CROIX FALLS", "physical_state": "WI", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1891", "legal_name": "WAGNER TRANSPORT LLC", "dba_name": null, "physical_city": "DYERSVILLE", "physical_state": "IA", "power_units": 3, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B-", "rank": 29, "insurance_rating": 455.03, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 4, "violation_count": 3, "annual_mileage": 244000, "violation_trends": {"Unsafe Driving": {"Q2 2025": 1}, "Vehicle Maintenance": {"Q3 2025": 1, "Q2 2024": 1}}, "critical_trends": {"Unsafe Driving": {"Q2 2025": 1}}}, {"dot_number": "1896", "legal_name": "WARREN TRANSPORT INC", "dba_name": null, "physical_city": "WATERLOO", "physical_state": "IA", "power_units": 375, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "D-", "rank": 57, "insurance_rating": 139.44, "risk_flags": "High crash frequency (27 crashes); Pattern: Vehicle Maintenance (194 violations); Pattern: Unsafe Driving (80 violations); Pattern: Hours-of-Service Compliance (13 violations)", "crash_count": 27, "inspection_count": 788, "violation_count": 289, "annual_mileage": 30093689, "violation_trends": {"Unsafe Driving": {"Q2 2024": 17, "Q1 2025": 9, "Q4 2024": 5, "Q1 2024": 9, "Q3 2024": 8, "Q2 2025": 8, "Q4 2025": 10, "Q3 2025": 11}, "Hours-of-Service Compliance": {"Q3 2024": 1, "Q4 2024": 2, "Q4 2025": 2, "Q2 2024": 4, "Q2 2025": 3, "Q1 2025": 1}, "Vehicle Maintenance": {"Q4 2024": 23, "Q1 2024": 10, "Q2 2025": 26, "Q3 2024": 32, "Q1 2025": 21, "Q2 2024": 29, "Q3 2025": 28, "Q4 2025": 17}, "Driver Fitness": {"Q1 2025": 2}}, "critical_trends": {"Unsafe Driving": {"Q2 2024": 5, "Q1 2025": 2, "Q4 2024": 1, "Q1 2024": 1, "Q3 2024": 3, "Q4 2025": 1, "Q3 2025": 3}, "Vehicle Maintenance": {"Q4 2024": 5, "Q1 2024": 4, "Q2 2025": 8, "Q3 2024": 4, "Q1 2025": 5, "Q2 2024": 6, "Q3 2025": 5, "Q4 2025": 7}, "Driver Fitness": {"Q1 2025": 1}, "Hours-of-Service Compliance": {"Q4 2024": 2, "Q2 2024": 1, "Q2 2025": 1}}}, {"dot_number": "1905", "legal_name": "WENGER TRUCK LINE INC", "dba_name": null, "physical_city": "DAVENPORT", "physical_state": "IA", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "High crash frequency (2 crashes)", "crash_count": 2, "inspection_count": 0, "violation_count": 0, "annual_mileage": 1, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "1931", "legal_name": "WITTENBURG TRUCK LINE INC", "dba_name": null, "physical_city": "READLYN", "physical_state": "IA", "power_units": 12, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B-", "rank": 30, "insurance_rating": 474.32, "risk_flags": "High crash frequency (2 crashes)", "crash_count": 2, "inspection_count": 10, "violation_count": 14, "annual_mileage": 565339, "violation_trends": {"Unsafe Driving": {"Q2 2024": 1, "Q1 2025": 1, "Q3 2025": 1, "Q4 2024": 1, "Q4 2025": 2}, "Hours-of-Service Compliance": {"Q4 2025": 1, "Q3 2025": 1}, "Vehicle Maintenance": {"Q3 2024": 6}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2024": 1}, "Unsafe Driving": {"Q4 2024": 1}}}, {"dot_number": "1948", "legal_name": "T R ANDERSEN TRUCKING INC", "dba_name": null, "physical_city": "AUDUBON", "physical_state": "IA", "power_units": 3, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 33041, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2030", "legal_name": "A-1 RELOCATION INC", "dba_name": null, "physical_city": "AURORA", "physical_state": "CO", "power_units": 9, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2046", "legal_name": "GARDA CL CENTRAL INC", "dba_name": null, "physical_city": "BOCA RATON", "physical_state": "FL", "power_units": 68, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 90.0, "inspection_score": 100.0, "combined_score": 97.0, "fred_score_grade": "C-", "rank": 48, "insurance_rating": 192.56, "risk_flags": "High crash frequency (3 crashes)", "crash_count": 3, "inspection_count": 7, "violation_count": 6, "annual_mileage": 1640000, "violation_trends": {"Vehicle Maintenance": {"Q2 2024": 3, "Q2 2025": 1}, "Driver Fitness": {"Q2 2024": 1}}, "critical_trends": {}}, {"dot_number": "2061", "legal_name": "FRANKLIN EXPRESS INC", "dba_name": null, "physical_city": "FRANKLIN", "physical_state": "KY", "power_units": 24, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B-", "rank": 31, "insurance_rating": 123.99, "risk_flags": "High crash frequency (2 crashes)", "crash_count": 2, "inspection_count": 28, "violation_count": 3, "annual_mileage": 1651438, "violation_trends": {"Vehicle Maintenance": {"Q4 2025": 1, "Q3 2025": 1}, "Driver Fitness": {"Q2 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q4 2025": 1, "Q3 2025": 1}}}, {"dot_number": "2075", "legal_name": "EDLIN BROTHERS INC", "dba_name": null, "physical_city": "NEW HAVEN", "physical_state": "KY", "power_units": 19, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 90.0, "combined_score": 98.0, "fred_score_grade": "C", "rank": 44, "insurance_rating": 426.12, "risk_flags": "High crash frequency (2 crashes); Pattern: Vehicle Maintenance (17 violations)", "crash_count": 2, "inspection_count": 27, "violation_count": 22, "annual_mileage": 737465, "violation_trends": {"Vehicle Maintenance": {"Q3 2024": 2, "Q3 2025": 1, "Q1 2025": 1, "Q4 2024": 2, "Q2 2024": 3, "Q1 2024": 8}, "Unsafe Driving": {"Q3 2025": 2, "Q2 2024": 2, "Q4 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2024": 2, "Q2 2024": 1, "Q1 2024": 1}, "Unsafe Driving": {"Q3 2025": 1, "Q2 2024": 1}}}, {"dot_number": "2092", "legal_name": "TGRC GATES CORPORATION", "dba_name": "GATES CORPORATION", "physical_city": "IOLA", "physical_state": "KS", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 70.0, "combined_score": 94.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "High OOS rate (100.0%)", "crash_count": 0, "inspection_count": 1, "violation_count": 1, "annual_mileage": 10000, "violation_trends": {"Vehicle Maintenance": {"Q4 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q4 2025": 1}}}, {"dot_number": "2107", "legal_name": "GOLDEN TRANSFER CO", "dba_name": null, "physical_city": "LONGMONT", "physical_state": "CO", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 10, "violation_count": 3, "annual_mileage": 20000, "violation_trends": {"Vehicle Maintenance": {"Q2 2024": 1, "Q3 2025": 2}}, "critical_trends": {}}, {"dot_number": "2304", "legal_name": "MERRIL FLEIG", "dba_name": "FLEIG TRUCKING", "physical_city": "FAIRFIELD", "physical_state": "IA", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2315", "legal_name": "FADIGA TRUCKING INC", "dba_name": null, "physical_city": "CENTERVILLE", "physical_state": "IA", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 98309, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2336", "legal_name": "NORTH BEND TRANSFER CO", "dba_name": "KRUGER FEED & SEED", "physical_city": "NORTH BEND", "physical_state": "NE", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "B-", "rank": 32, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 989863, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2340", "legal_name": "KORTH TRUCKING INC", "dba_name": null, "physical_city": "NORFOLK", "physical_state": "NE", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "C+", "rank": 33, "insurance_rating": 79.91, "risk_flags": "", "crash_count": 0, "inspection_count": 18, "violation_count": 4, "annual_mileage": 288423, "violation_trends": {"Vehicle Maintenance": {"Q2 2024": 1, "Q1 2024": 1}, "Unsafe Driving": {"Q2 2025": 1}, "Hours-of-Service Compliance": {"Q4 2024": 1}}, "critical_trends": {"Unsafe Driving": {"Q2 2025": 1}}}, {"dot_number": "2345", "legal_name": "KNIGHT LLC", "dba_name": null, "physical_city": "ORD", "physical_state": "NE", "power_units": 3, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "C+", "rank": 34, "insurance_rating": 1, "risk_flags": "", "crash_count": 0, "inspection_count": 2, "violation_count": 0, "annual_mileage": 136000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2351", "legal_name": "BISSELL-BABCOCK MILLWORK INC", "dba_name": null, "physical_city": "SHERMAN", "physical_state": "NY", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 0, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2408", "legal_name": "BELT TRANSFER COMPANY INC", "dba_name": null, "physical_city": "RAVENSWOOD", "physical_state": "WV", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "C+", "rank": 35, "insurance_rating": 243.51, "risk_flags": "", "crash_count": 0, "inspection_count": 11, "violation_count": 8, "annual_mileage": 189306, "violation_trends": {"Vehicle Maintenance": {"Q4 2025": 3, "Q2 2024": 1}, "Driver Fitness": {"Q4 2025": 2, "Q3 2025": 1}, "Unsafe Driving": {"Q4 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q2 2024": 1}, "Driver Fitness": {"Q4 2025": 1, "Q3 2025": 1}}}, {"dot_number": "2409", "legal_name": "BOGGESS TRUCKING LLC", "dba_name": null, "physical_city": "NITRO", "physical_state": "WV", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 15000, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2413", "legal_name": "BURNS MOTOR FREIGHT INC", "dba_name": null, "physical_city": "MARLINTON", "physical_state": "WV", "power_units": 65, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 90.0, "inspection_score": 100.0, "combined_score": 97.0, "fred_score_grade": "C-", "rank": 49, "insurance_rating": 193.62, "risk_flags": "High crash frequency (4 crashes); Pattern: Vehicle Maintenance (34 violations)", "crash_count": 4, "inspection_count": 71, "violation_count": 42, "annual_mileage": 3186576, "violation_trends": {"Unsafe Driving": {"Q2 2024": 1, "Q3 2024": 1, "Q4 2025": 1}, "Hours-of-Service Compliance": {"Q2 2025": 3, "Q4 2025": 1, "Q3 2024": 1}, "Vehicle Maintenance": {"Q4 2024": 4, "Q1 2025": 7, "Q2 2025": 9, "Q3 2024": 10, "Q4 2025": 3, "Q3 2025": 1}}, "critical_trends": {"Hours-of-Service Compliance": {"Q2 2025": 3, "Q4 2025": 1}, "Unsafe Driving": {"Q3 2024": 1, "Q4 2025": 1}, "Vehicle Maintenance": {"Q1 2025": 1, "Q2 2025": 1, "Q3 2025": 1}}}, {"dot_number": "2451", "legal_name": "L J NAVY TRUCKING CO", "dba_name": null, "physical_city": "CIRCLEVILLE", "physical_state": "OH", "power_units": 3, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 1, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2460", "legal_name": "RHODES BRICK & BLOCK INC", "dba_name": null, "physical_city": "SAINT ALBANS", "physical_state": "WV", "power_units": 13, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 25, "violation_count": 7, "annual_mileage": 31451, "violation_trends": {"Unsafe Driving": {"Q2 2025": 1, "Q3 2025": 2}, "Vehicle Maintenance": {"Q2 2024": 1, "Q3 2024": 2, "Q3 2025": 1}}, "critical_trends": {"Unsafe Driving": {"Q2 2025": 1}, "Vehicle Maintenance": {"Q2 2024": 1, "Q3 2024": 2}}}, {"dot_number": "2477", "legal_name": "JOHN S WATSON TRUCKING COMPANY LLC", "dba_name": null, "physical_city": "WESTON", "physical_state": "WV", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 0, "violation_count": 2, "annual_mileage": 22000, "violation_trends": {"Vehicle Maintenance": {"Q3 2025": 1}, "Driver Fitness": {"Q3 2025": 1}}, "critical_trends": {}}, {"dot_number": "2489", "legal_name": "ANDERSON ERICKSON DAIRY COMPANY", "dba_name": "AE", "physical_city": "DES MOINES", "physical_state": "IA", "power_units": 175, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 85.0, "inspection_score": 100.0, "combined_score": 95.5, "fred_score_grade": "F", "rank": 58, "insurance_rating": 242.3, "risk_flags": "High crash frequency (8 crashes); Pattern: Vehicle Maintenance (25 violations); Pattern: Unsafe Driving (15 violations)", "crash_count": 8, "inspection_count": 57, "violation_count": 41, "annual_mileage": 4070000, "violation_trends": {"Unsafe Driving": {"Q1 2024": 1, "Q3 2024": 3, "Q4 2025": 4, "Q1 2025": 2, "Q2 2024": 1, "Q3 2025": 3, "Q4 2024": 1}, "Vehicle Maintenance": {"Q3 2024": 3, "Q2 2025": 3, "Q1 2024": 3, "Q3 2025": 10, "Q2 2024": 4}, "Hours-of-Service Compliance": {"Q2 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2024": 1, "Q1 2024": 1}, "Unsafe Driving": {"Q4 2025": 1, "Q1 2025": 2, "Q2 2024": 1}, "Hours-of-Service Compliance": {"Q2 2025": 1}}}, {"dot_number": "2497", "legal_name": "ALTER TRUCKING AND TERMINAL CORPORATION", "dba_name": null, "physical_city": "BETTENDORF", "physical_state": "IA", "power_units": 5, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 0, "violation_count": 0, "annual_mileage": 1, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2516", "legal_name": "BARTON SOLVENTS INC", "dba_name": null, "physical_city": "DES MOINES", "physical_state": "IA", "power_units": 107, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "C+", "rank": 36, "insurance_rating": 187.78, "risk_flags": "High crash frequency (2 crashes); Pattern: Vehicle Maintenance (62 violations); Pattern: Hazardous Materials Compliance (14 violations)", "crash_count": 2, "inspection_count": 235, "violation_count": 90, "annual_mileage": 3760083, "violation_trends": {"Hazardous Materials Compliance": {"Q2 2025": 4, "Q1 2025": 1, "Q1 2024": 2, "Q3 2024": 1, "Q4 2025": 1, "Q3 2025": 5}, "Hours-of-Service Compliance": {"Q4 2025": 3, "Q2 2025": 1, "Q1 2025": 1}, "Unsafe Driving": {"Q4 2025": 1, "Q4 2024": 2, "Q3 2024": 1, "Q2 2024": 1, "Q2 2025": 2, "Q1 2024": 1}, "Vehicle Maintenance": {"Q3 2025": 13, "Q4 2025": 4, "Q4 2024": 1, "Q2 2025": 8, "Q1 2025": 2, "Q2 2024": 10, "Q1 2024": 6, "Q3 2024": 18}, "Driver Fitness": {"Q1 2024": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2025": 2, "Q4 2025": 1, "Q2 2025": 1, "Q1 2024": 3}, "Hazardous Materials Compliance": {"Q1 2024": 1, "Q3 2024": 1, "Q3 2025": 1}}}, {"dot_number": "2556", "legal_name": "CAROL BARCLAY TRUCKING", "dba_name": null, "physical_city": "HOMER", "physical_state": "NE", "power_units": 2, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 70.0, "combined_score": 94.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "High OOS rate (100.0%)", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 4191, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2566", "legal_name": "C & H HEAVY DUTY SPECIALIST INC", "dba_name": "C & H TOWING SERVICE", "physical_city": "SOUTH SIOUX CITY", "physical_state": "NE", "power_units": 4, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 1, "violation_count": 0, "annual_mileage": 32757, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2575", "legal_name": "H & I TRUCKING LLC", "dba_name": null, "physical_city": "HETLAND", "physical_state": "SD", "power_units": 11, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 80.0, "combined_score": 96.0, "fred_score_grade": "C-", "rank": 50, "insurance_rating": 500, "risk_flags": "High crash frequency (2 crashes); Elevated OOS rate (41.7%); Pattern: Vehicle Maintenance (37 violations)", "crash_count": 2, "inspection_count": 12, "violation_count": 39, "annual_mileage": 575000, "violation_trends": {"Vehicle Maintenance": {"Q3 2024": 13, "Q1 2024": 14, "Q2 2024": 1, "Q4 2025": 9}, "Unsafe Driving": {"Q2 2024": 1}, "Driver Fitness": {"Q4 2025": 1}}, "critical_trends": {"Vehicle Maintenance": {"Q3 2024": 1, "Q1 2024": 1, "Q4 2025": 1}, "Unsafe Driving": {"Q2 2024": 1}, "Driver Fitness": {"Q4 2025": 1}}}, {"dot_number": "2588", "legal_name": "MERRILL LARSON TRANSFER INC", "dba_name": null, "physical_city": "OAKLAND", "physical_state": "NE", "power_units": 10, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "C+", "rank": 37, "insurance_rating": 133.8, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 19, "violation_count": 3, "annual_mileage": 829822, "violation_trends": {"Unsafe Driving": {"Q1 2024": 1, "Q3 2025": 2}}, "critical_trends": {"Unsafe Driving": {"Q3 2025": 2}}}, {"dot_number": "2636", "legal_name": "LEWIS & SON TRUCKING LLC", "dba_name": null, "physical_city": "GLASGOW", "physical_state": "MO", "power_units": 1, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": null, "rank": null, "insurance_rating": null, "risk_flags": "", "crash_count": 0, "inspection_count": 2, "violation_count": 0, "annual_mileage": 53922, "violation_trends": {}, "critical_trends": {}}, {"dot_number": "2662", "legal_name": "STAN ALLES", "dba_name": "STAN ALLES TRANSPORT", "physical_city": "FRESNO", "physical_state": "CA", "power_units": 14, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "C+", "rank": 38, "insurance_rating": 189.66, "risk_flags": "High crash frequency (1 crashes)", "crash_count": 1, "inspection_count": 32, "violation_count": 15, "annual_mileage": 950000, "violation_trends": {"Hours-of-Service Compliance": {"Q1 2024": 1}, "Vehicle Maintenance": {"Q4 2024": 1, "Q2 2024": 1, "Q2 2025": 2, "Q1 2024": 2}, "Hazardous Materials Compliance": {"Q2 2025": 3, "Q1 2024": 4}, "Unsafe Driving": {"Q4 2025": 1}}, "critical_trends": {}}, {"dot_number": "2955", "legal_name": "TREVIS BERRY TRANSPORTATION", "dba_name": null, "physical_city": "GILROY", "physical_state": "CA", "power_units": 49, "drivers": 0, "experience_score": 100.0, "safety_score": 100.0, "crash_score": 100.0, "inspection_score": 100.0, "combined_score": 100.0, "fred_score_grade": "C", "rank": 39, "insurance_rating": 168.12, "risk_flags": "High crash frequency (1 crashes); Pattern: Vehicle Maintenance (56 violations)", "crash_count": 1, "inspection_count": 302, "violation_count": 65, "annual_mileage": 2785446, "violation_trends": {"Hours-of-Service Compliance": {"Q2 2024": 1}, "Driver Fitness": {"Q2 2025": 1, "Q3 2025": 1, "Q4 2025": 2}, "Unsafe Driving": {"Q3 2025": 2, "Q1 2024": 2}, "Vehicle Maintenance": {"Q3 2024": 7, "Q4 2025": 11, "Q3 2025": 1, "Q4 2024": 5, "Q1 2024": 4, "Q2 2024": 7, "Q1 2025": 11, "Q2 2025": 8}}, "critical_trends": {"Driver Fitness": {"Q2 2025": 1, "Q4 2025": 1}, "Vehicle Maintenance": {"Q3 2024": 1, "Q4 2025": 2, "Q4 2024": 1, "Q1 2025": 1, "Q2 2025": 1}}}];

        // BASIC category colors
        const CATEGORY_COLORS = {
            'Unsafe Driving': '#e53e3e',
            'Hours-of-Service Compliance': '#dd6b20',
            'Driver Fitness': '#d69e2e',
            'Controlled Substances/Alcohol': '#805ad5',
            'Vehicle Maintenance': '#3182ce',
            'Hazardous Materials Compliance': '#38a169'
        };

        // Chart instances
        let trendChart = null;
        let criticalTrendChart = null;
        let categoryChart = null;
        let severityChart = null;

        // Search functionality
        const searchInput = document.getElementById('carrierSearch');
        const searchResults = document.getElementById('searchResults');

        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            if (query.length < 2) {
                searchResults.style.display = 'none';
                return;
            }

            const matches = CARRIERS.filter(c => {
                const name = (c.legal_name || '').toLowerCase();
                const dba = (c.dba_name || '').toLowerCase();
                const dot = (c.dot_number || '').toLowerCase();
                return name.includes(query) || dba.includes(query) || dot.includes(query);
            }).slice(0, 20);

            if (matches.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item">No carriers found</div>';
            } else {
                searchResults.innerHTML = matches.map(c => `
                    <div class="search-result-item" onclick="selectCarrier('${c.dot_number}')">
                        <div class="carrier-name">${c.legal_name || 'Unknown'}</div>
                        <div class="carrier-info">DOT# ${c.dot_number} | ${c.physical_city || ''}, ${c.physical_state || ''} | ${c.fred_score_grade || 'N/A'}</div>
                    </div>
                `).join('');
            }
            searchResults.style.display = 'block';
        });

        document.addEventListener('click', function(e) {
            if (!searchResults.contains(e.target) && e.target !== searchInput) {
                searchResults.style.display = 'none';
            }
        });

        function selectCarrier(dotNumber) {
            const carrier = CARRIERS.find(c => c.dot_number === dotNumber);
            if (!carrier) return;

            searchResults.style.display = 'none';
            searchInput.value = carrier.legal_name || dotNumber;

            document.getElementById('noSelection').style.display = 'none';
            document.getElementById('carrierDetails').classList.add('active');

            // Update header info
            document.getElementById('carrierName').textContent = carrier.legal_name || 'Unknown';
            document.getElementById('carrierDOT').textContent = carrier.dot_number;
            document.getElementById('carrierLocation').textContent =
                [carrier.physical_city, carrier.physical_state].filter(Boolean).join(', ') || 'N/A';
            document.getElementById('carrierPowerUnits').textContent =
                carrier.power_units ? carrier.power_units.toLocaleString() : 'N/A';
            document.getElementById('carrierDrivers').textContent =
                carrier.drivers ? carrier.drivers.toLocaleString() : 'N/A';
            document.getElementById('carrierMileage').textContent =
                carrier.annual_mileage ? carrier.annual_mileage.toLocaleString() + ' mi' : 'N/A';

            // Update grade badge
            const gradeBadge = document.getElementById('gradeBadge');
            const grade = carrier.fred_score_grade || 'N/A';
            gradeBadge.textContent = grade;
            gradeBadge.className = 'grade-badge grade-' + (grade.charAt(0) || 'NA');

            // Update scores
            updateScore('scoreCombined', carrier.combined_score);
            updateScore('scoreExperience', carrier.experience_score);
            updateScore('scoreSafety', carrier.safety_score);
            updateScore('scoreCrash', carrier.crash_score);
            updateScore('scoreInspection', carrier.inspection_score);

            // Update stats
            document.getElementById('statCrashes').textContent = carrier.crash_count || 0;
            document.getElementById('statInspections').textContent = carrier.inspection_count || 0;
            document.getElementById('statViolations').textContent = carrier.violation_count || 0;
            document.getElementById('statInsurance').textContent =
                carrier.insurance_rating ? carrier.insurance_rating.toFixed(1) : 'N/A';

            // Update ranking
            const rankingInfo = document.getElementById('rankingInfo');
            if (carrier.rank) {
                const percentile = ((1 - carrier.rank / 100) * 100).toFixed(1);
                document.getElementById('rankingText').textContent =
                    `Ranked #${carrier.rank.toLocaleString()} out of 100 carriers (Top ${percentile}%)`;
                rankingInfo.style.display = 'block';
            } else {
                rankingInfo.style.display = 'none';
            }

            // Update risk flags
            const riskFlagsDiv = document.getElementById('riskFlags');
            const riskFlagsList = document.getElementById('riskFlagsList');
            if (carrier.risk_flags) {
                const flags = carrier.risk_flags.split('; ').filter(Boolean);
                if (flags.length > 0) {
                    riskFlagsList.innerHTML = flags.map(f => `<li>${f}</li>`).join('');
                    riskFlagsDiv.style.display = 'block';
                } else {
                    riskFlagsDiv.style.display = 'none';
                }
            } else {
                riskFlagsDiv.style.display = 'none';
            }

            // Render charts
            renderCharts(carrier);
        }

        function updateScore(elementId, score) {
            const el = document.getElementById(elementId);
            if (score !== null && score !== undefined) {
                el.textContent = score.toFixed(1);
                el.className = 'score-value ' + (score >= 70 ? 'good' : score >= 40 ? 'medium' : 'bad');
            } else {
                el.textContent = 'N/A';
                el.className = 'score-value';
            }
        }

        function getQuartersSorted(trends) {
            const allQuarters = new Set();
            Object.values(trends).forEach(categoryData => {
                Object.keys(categoryData).forEach(q => allQuarters.add(q));
            });
            return Array.from(allQuarters).sort((a, b) => {
                const [qa, ya] = [a.substring(0, 2), parseInt(a.substring(3))];
                const [qb, yb] = [b.substring(0, 2), parseInt(b.substring(3))];
                if (ya !== yb) return ya - yb;
                return qa.localeCompare(qb);
            });
        }

        function renderCharts(carrier) {
            const trends = carrier.violation_trends || {};
            const criticalTrends = carrier.critical_trends || {};

            // Get all quarters
            const allTrendsQuarters = getQuartersSorted(trends);
            const allCriticalQuarters = getQuartersSorted(criticalTrends);
            const quarters = allTrendsQuarters.length > 0 ? allTrendsQuarters : allCriticalQuarters;

            // Categories
            const categories = Object.keys(CATEGORY_COLORS);

            // Destroy existing charts
            if (trendChart) trendChart.destroy();
            if (criticalTrendChart) criticalTrendChart.destroy();
            if (categoryChart) categoryChart.destroy();
            if (severityChart) severityChart.destroy();

            // 1. Trend Line Chart (All Violations)
            const trendDatasets = categories.map(cat => ({
                label: cat,
                data: quarters.map(q => (trends[cat] || {})[q] || 0),
                borderColor: CATEGORY_COLORS[cat],
                backgroundColor: CATEGORY_COLORS[cat] + '20',
                tension: 0.3,
                fill: false
            })).filter(ds => ds.data.some(v => v > 0));

            trendChart = new Chart(document.getElementById('trendChart'), {
                type: 'line',
                data: {
                    labels: quarters,
                    datasets: trendDatasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { boxWidth: 12, padding: 15 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });

            // 2. Critical Violations Trend
            const criticalDatasets = categories.map(cat => ({
                label: cat,
                data: quarters.map(q => (criticalTrends[cat] || {})[q] || 0),
                borderColor: CATEGORY_COLORS[cat],
                backgroundColor: CATEGORY_COLORS[cat] + '20',
                tension: 0.3,
                fill: false
            })).filter(ds => ds.data.some(v => v > 0));

            criticalTrendChart = new Chart(document.getElementById('criticalTrendChart'), {
                type: 'line',
                data: {
                    labels: quarters,
                    datasets: criticalDatasets.length > 0 ? criticalDatasets : [{
                        label: 'No Critical Violations',
                        data: quarters.map(() => 0),
                        borderColor: '#ccc'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { boxWidth: 12, padding: 15 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });

            // 3. Category Bar Chart
            const categoryTotals = categories.map(cat => {
                let total = 0;
                Object.values(trends[cat] || {}).forEach(v => total += v);
                return total;
            });

            categoryChart = new Chart(document.getElementById('categoryChart'), {
                type: 'bar',
                data: {
                    labels: categories.map(c => c.replace(' Compliance', '').replace('Controlled Substances/Alcohol', 'Drugs/Alcohol')),
                    datasets: [{
                        label: 'Total Violations',
                        data: categoryTotals,
                        backgroundColor: categories.map(c => CATEGORY_COLORS[c])
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });

            // 4. Critical vs Regular Violations
            const criticalTotals = categories.map(cat => {
                let total = 0;
                Object.values(criticalTrends[cat] || {}).forEach(v => total += v);
                return total;
            });
            const regularTotals = categoryTotals.map((t, i) => t - criticalTotals[i]);

            severityChart = new Chart(document.getElementById('severityChart'), {
                type: 'bar',
                data: {
                    labels: categories.map(c => c.replace(' Compliance', '').replace('Controlled Substances/Alcohol', 'Drugs/Alcohol')),
                    datasets: [
                        {
                            label: 'Critical (Severity >= 7)',
                            data: criticalTotals,
                            backgroundColor: '#e53e3e'
                        },
                        {
                            label: 'Regular',
                            data: regularTotals,
                            backgroundColor: '#3182ce'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { boxWidth: 12, padding: 15 }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            stacked: true,
                            ticks: { stepSize: 1 }
                        },
                        y: {
                            stacked: true
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
